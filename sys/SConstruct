Import('*')

libs = Glob('lib/*.[cs]') 
common = Glob('common/*.c')
i686src = Glob('i686/*.[sc]')

includepaths = [ '.', 'include/', 'lib/']


sources = libs
sources += common

if architecture == "i686":
  sources.extend(i686src)
  env.Append(CFLAGS=" -fstack-protector")


objects = []
for item in sources:
  objects += env.Object(item, CPPPATH=includepaths)

env.Kernel('kernel', objects)
